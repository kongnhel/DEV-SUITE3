<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI Code Reviewer 2026 | Neural Responsive</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/socket.io/socket.io.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kantumruy+Pro:wght@300;400;700&family=Space+Grotesk:wght@300;500;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />

    <style>
        :root { --primary: #00f2ff; --secondary: #7000ff; --bg: #030712; }
        body { font-family: "Kantumruy Pro", sans-serif; background-color: var(--bg); color: #e2e8f0; overflow-x: hidden; }
        
        #neural-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; opacity: 0.2; }
        
        /* Glass Navbar from Culture Style */
        .nav-glass { background: rgba(3, 7, 18, 0.7); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(0, 242, 255, 0.1); }
        
        .nav-link { position: relative; color: #94a3b8; transition: all 0.3s ease; }
        .nav-link.active { color: var(--primary); border-bottom: 2px solid var(--primary); }

        /* Responsive Neural Card */
        .neural-card {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(0, 242, 255, 0.15);
            border-radius: 20px; /* Mobile */
            transition: all 0.4s ease;
        }
        @media (min-width: 768px) {
            .neural-card { border-radius: 32px; } /* Desktop */
        }

        .shimmer-text {
            background: linear-gradient(90deg, #fff, var(--primary), #fff);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 4s linear infinite;
        }
        @keyframes shine { to { background-position: 200% center; } }

        /* Hide scrollbar for mobile nav */
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>

<body class="min-h-screen">
    <canvas id="neural-bg"></canvas>

    <nav class="sticky top-0 z-[100] nav-glass px-4 py-3 md:px-6 md:py-4">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2 cursor-pointer" onclick="window.location.href = '/'">
                <div class="h-8 w-8 md:h-10 md:w-10 rounded-xl bg-gradient-to-br from-cyan-500 to-purple-600 flex items-center justify-center">
                    <span class="text-black font-black text-sm md:text-xl italic">AI</span>
                </div>
                <h1 class="text-lg md:text-2xl font-black tracking-tighter shimmer-text">DEV SUITE</h1>
            </div>
            <div class="flex items-center gap-2">
                <span class="text-[8px] md:text-[10px] font-mono text-cyan-500 uppercase">System: Online</span>
                <div class="h-2 w-2 rounded-full bg-cyan-500 animate-pulse"></div>
            </div>
        </div>

        <div class="flex md:hidden gap-6 mt-4 overflow-x-auto pb-1 text-[10px] font-bold uppercase tracking-widest no-scrollbar border-t border-white/5 pt-3">
            <a href="/" class="text-cyan-400 border-b border-cyan-400 whitespace-nowrap">Reviewer</a>
            <a href="/culture" class="text-slate-400 whitespace-nowrap">Culture</a>
            <a href="/visualizer" class="text-slate-400 whitespace-nowrap">Visualizer</a>
            <a href="/study-buddy" class="text-slate-400 whitespace-nowrap">Study Buddy</a>
            <a href="/kida" class="text-slate-400 whitespace-nowrap">K-IDA</a>
        </div>

        <div class="hidden md:flex justify-center gap-10 text-xs font-bold uppercase tracking-widest mt-[-20px]">
            <a href="/" class="nav-link active">Reviewer</a>
            <a href="/culture" class="nav-link">Culture</a>
            <a href="/visualizer" class="nav-link">Visualizer</a>
            <a href="/study-buddy" class="nav-link">Study Buddy</a>
            <a href="/kida" class="nav-link">K-IDA</a>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto p-4 md:p-12">
        <header class="text-center mb-10 md:mb-16 relative">
            <div class="absolute -top-10 left-1/2 -translate-x-1/2 w-48 h-48 md:w-64 md:h-64 bg-cyan-500/10 blur-[80px] -z-10"></div>
            <h2 class="text-5xl md:text-8xl font-black tracking-tighter shimmer-text italic uppercase">EVOLUTION</h2>
            <p class="mt-2 text-slate-500 font-mono tracking-[0.2em] md:tracking-[0.5em] text-[8px] md:text-[10px] uppercase px-4">Where Logic Meets Empathy | Diagnostic Neural Link</p>
        </header>

        <div class="grid grid-cols-1 xl:grid-cols-12 gap-6 md:gap-10">
            <div class="xl:col-span-6 space-y-6 md:space-y-10">
                <div class="neural-card p-6 md:p-12">
                    <div class="flex items-center gap-3 mb-6 md:mb-8">
                        <div class="h-4 w-1 bg-cyan-500 rounded-full"></div>
                        <h3 class="text-sm md:text-xl font-bold text-cyan-200 uppercase tracking-widest">Connect to Hub</h3>
                    </div>

                    <div class="space-y-6">
                        <div>
                            <label class="block text-[10px] font-bold text-cyan-500 uppercase tracking-widest mb-3 ml-2">How do you feel?</label>
                            <textarea id="userComment" class="w-full h-32 md:h-40 bg-black/40 border border-white/10 rounded-xl md:rounded-3xl p-5 md:p-8 outline-none text-base md:text-xl text-slate-200 transition-all focus:ring-1 focus:ring-cyan-500/50" placeholder="តើប្អូនមានអារម្មណ៍យ៉ាងណាជាមួយកូដនេះ?"></textarea>
                        </div>
                        <div>
                            <label class="block text-[10px] font-bold text-cyan-500 uppercase tracking-widest mb-3 ml-2">Broken Code</label>
                            <textarea id="code" class="w-full h-[350px] md:h-[500px] bg-black/40 border border-white/10 rounded-xl md:rounded-3xl p-5 md:p-8 outline-none font-mono text-sm md:text-base text-cyan-50 focus:ring-1 focus:ring-cyan-500/50" placeholder="// Paste your broken logic here..."></textarea>
                        </div>
                        <button onclick="sendCode()" id="btnSend" class="w-full py-5 md:py-6 rounded-2xl md:rounded-full font-black text-base md:text-lg text-black bg-cyan-400 hover:bg-cyan-300 shadow-2xl active:scale-95 transition-all uppercase tracking-widest flex justify-center items-center gap-3">
                            <span>Execute Analysis</span>
                            <svg class="h-5 w-5 md:h-6 md:w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path d="M13 10V3L4 14h7v7l9-11h-7z" stroke-width="3" /></svg>
                        </button>
                    </div>
                </div>
            </div>

            <div class="xl:col-span-6">
                <div id="loading" class="hidden neural-card p-20 md:p-40 flex flex-col items-center justify-center">
                    <div class="w-16 h-16 border-4 border-cyan-500/20 border-t-cyan-500 rounded-full animate-spin"></div>
                    <p class="mt-6 text-cyan-500 font-mono text-[10px] tracking-widest animate-pulse">NEURAL_SYNCING...</p>
                </div>

                <div id="aiSection" class="hidden space-y-6 md:space-y-8 animate-in slide-in-from-bottom-5">
                    <div class="neural-card p-6 md:p-10 border-l-8 border-cyan-500 bg-cyan-500/5">
                        <div id="aiMood" class="text-[9px] md:text-[10px] font-black tracking-widest uppercase mb-3 text-cyan-400"></div>
                        <div id="aiJoke" class="text-2xl md:text-4xl font-light text-white italic leading-tight"></div>
                    </div>

                    <div class="neural-card p-6 md:p-10">
                        <h4 class="text-cyan-500 font-bold uppercase tracking-widest text-[9px] md:text-[10px] mb-4">Diagnostic Summary</h4>
                        <div id="aiReview" class="text-slate-400 leading-relaxed space-y-4 font-light text-sm md:text-xl"></div>
                    </div>

                    <div class="neural-card overflow-hidden">
                        <div class="px-6 md:px-10 py-4 bg-white/5 border-b border-white/5 flex justify-between items-center">
                            <span class="text-[9px] font-black tracking-widest text-slate-500 uppercase">Optimized_Result.js</span>
                            <button onclick="copyCode()" class="text-[10px] font-bold text-cyan-400 uppercase hover:text-white transition-colors">Copy Unit</button>
                        </div>
                        <pre class="p-6 md:p-10 overflow-x-auto no-scrollbar"><code id="fixedCode" class="language-javascript text-xs md:text-base"></code></pre>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="mt-10 py-10 border-t border-white/5 text-center px-6">
        <p class="text-slate-600 text-[8px] md:text-[10px] tracking-widest uppercase mb-2">Developed for Future Innovators</p>
        <p class="text-cyan-500/40 text-[6px] md:text-[8px] font-mono">&copy; 2026 AI DEV SUITE PROTOCOL</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script>
        const socket = io();
        const btnSend = document.getElementById("btnSend");
        const loading = document.getElementById("loading");
        const aiSection = document.getElementById("aiSection");

        function sendCode() {
            const code = document.getElementById("code").value.trim();
            if (!code) return Swal.fire({ icon: "error", title: "Empty Data", text: "ដាក់កូដមកអាអូន កុំទុកឱ្យបងនៅទំនេរ!", background: "#030712", color: "#00f2ff", confirmButtonColor: "#00f2ff" });
            loading.classList.remove("hidden");
            aiSection.classList.add("hidden");
            btnSend.disabled = true;
            btnSend.style.opacity = "0.3";
            socket.emit("review_code", { code, userComment: document.getElementById("userComment").value });
        }

        socket.on("review_result", (res) => {
            loading.classList.add("hidden");
            aiSection.classList.remove("hidden");
            btnSend.disabled = false;
            btnSend.style.opacity = "1";
            document.getElementById("aiMood").innerText = "Sentiment: " + res.sentiment;
            typeWriter("aiJoke", "“" + res.humorous_response + "”");
            document.getElementById("aiReview").innerHTML = res.technical_review.replace(/\n/g, "<br>");
            const codeContainer = document.getElementById("fixedCode");
            codeContainer.textContent = res.fixed_code || "// Logic verified. No changes needed.";
            Prism.highlightElement(codeContainer);
        });

        function typeWriter(id, text) {
            let i = 0; const el = document.getElementById(id); el.innerHTML = "";
            function type() { if (i < text.length) { el.innerHTML += text.charAt(i); i++; setTimeout(type, 20); } }
            type();
        }

        function copyCode() {
            navigator.clipboard.writeText(document.getElementById("fixedCode").textContent);
            Swal.fire({ icon: "success", title: "Synced", toast: true, position: "top-end", showConfirmButton: false, timer: 2000, background: "#030712", color: "#00f2ff" });
        }

        // Neural Star BG
        const canvas = document.getElementById("neural-bg");
        const ctx = canvas.getContext("2d");
        let dots = [];
        function init() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            dots = [];
            for (let i = 0; i < 40; i++) dots.push({ x: Math.random() * canvas.width, y: Math.random() * canvas.height, vx: (Math.random() - 0.5) * 0.3, vy: (Math.random() - 0.5) * 0.3 });
        }
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "#00f2ff"; ctx.strokeStyle = "rgba(0,242,255,0.03)";
            dots.forEach((d) => {
                d.x += d.vx; d.y += d.vy;
                if (d.x < 0 || d.x > canvas.width) d.vx *= -1;
                if (d.y < 0 || d.y > canvas.height) d.vy *= -1;
                ctx.beginPath(); ctx.arc(d.x, d.y, 0.6, 0, Math.PI * 2); ctx.fill();
                dots.forEach((d2) => {
                    if (Math.hypot(d.x - d2.x, d.y - d2.y) < 180) {
                        ctx.beginPath(); ctx.moveTo(d.x, d.y); ctx.lineTo(d2.x, d2.y); ctx.stroke();
                    }
                });
            });
            requestAnimationFrame(draw);
        }
        window.addEventListener("resize", init); init(); draw();
    </script>
</body>
</html>