<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Khmer Culture 2026 | Royal Cyber Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/socket.io/socket.io.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Freehand&family=Kantumruy+Pro:wght@300;400;700&family=Space+Grotesk:wght@300;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        :root {
            --royal-gold: #d4af37;
            --deep-bronze: #8b4513;
        }
        body {
            font-family: 'Kantumruy Pro', sans-serif;
            background: #0a0a0a;
            color: #f3f4f6;
            overflow-x: hidden;
        }

        /* Animated Royal Background */
        .bg-royal {
            position: fixed;
            inset: 0;
            background: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #050505 100%);
            z-index: -2;
        }
        .bg-pattern {
            position: fixed;
            inset: 0;
            background-image: url('https://www.transparenttextures.com/patterns/pinstriped-suit.png');
            opacity: 0.05;
            z-index: -1;
        }

        .gold-glow-card {
            background: rgba(20, 20, 20, 0.8);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .gold-glow-card:hover {
            border-color: rgba(212, 175, 55, 0.5);
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.1);
        }

        .btn-khmer {
            background: linear-gradient(135deg, #b8860b 0%, #ffd700 50%, #b8860b 100%);
            background-size: 200% auto;
            color: #000;
            font-weight: 800;
            transition: 0.5s;
        }
        .btn-khmer:hover {
            background-position: right center;
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);
        }

        .title-khmer {
            font-family: 'Freehand', cursive;
            background: linear-gradient(to bottom, #ffd700, #b8860b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .cursor::after {
            content: "|";
            animation: blink 0.7s infinite;
        }
        @keyframes blink { 50% { opacity: 0; } }

        /* Custom Styling for Select Input */
        select option {
            background: #1a1a1a;
            color: #ffd700;
        }
    </style>
</head>

<body>
    <div class="bg-royal"></div>
    <div class="bg-pattern"></div>

    <nav class="sticky top-0 z-50 border-b border-white/5 bg-black/50 backdrop-blur-lg px-6 py-4">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-black tracking-tighter text-yellow-500">AI DEV SUITE</h1>
            <div class="hidden md:flex gap-10 text-xs font-bold uppercase tracking-widest">
                <a href="/" class="text-slate-400 hover:text-yellow-500 transition">Reviewer</a>
                <a href="/culture" class="text-yellow-500 border-b border-yellow-500">Culture</a>
                <a href="/visualizer" class="text-slate-400 hover:text-yellow-500 transition">Visualizer</a>
                <a href="/study-buddy" class="text-slate-400 hover:text-yellow-500 transition">Study Buddy</a>
            </div>
            <div class="flex items-center gap-2">
                <span class="text-[10px] font-mono text-yellow-600">NODE_STATUS: ACTIVE</span>
                <div class="h-2 w-2 rounded-full bg-yellow-500 animate-pulse"></div>
            </div>
        </div>
    </nav>

    <main class="max-w-5xl mx-auto p-6 md:p-12">
        <header class="text-center mb-16 relative">
            <div class="absolute -top-10 left-1/2 -translate-x-1/2 w-64 h-64 bg-yellow-600/10 blur-[100px] -z-10"></div>
            <h2 class="text-5xl md:text-7xl font-bold mb-4 title-khmer">á˜á‚áŸ’á‚á»á‘áŸ’á‘áŸáŸá€áŸáœá”áŸ’á”á’á˜áŸŒááŸ’á˜áŸ‚áš</h2>
            <p class="text-slate-400 font-light tracking-[0.2em] uppercase text-sm">Empowering Heritage with AI Neural Intelligence</p>
        </header>

        <div class="grid grid-cols-1 gap-10">
            <div class="gold-glow-card p-8 md:p-12">
                <div class="flex items-center gap-4 mb-6">
                    <div class="bg-yellow-500/10 p-3 rounded-full border border-yellow-500/20">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#d4af37" stroke-width="2"><path d="M12 21l-8-4V7l8-4 8 4v10l-8 4z"/></svg>
                    </div>
                    <h3 class="text-xl font-bold text-yellow-200">áŸá¶á€áŸá½ášá¢áŸ†á–á¸á…áŸ†ááŸáŸ‡áŠá¹á„á‘á¼á‘áŸ…</h3>
                </div>
                
                <textarea 
                    id="questionInput" 
                    class="w-full h-40 bg-black/40 border border-white/5 rounded-2xl p-6 focus:ring-2 focus:ring-yellow-500/50 outline-none text-xl leading-relaxed text-slate-200 transition-all placeholder:text-slate-600 mb-6"
                    placeholder="á§á‘á¶á ášááŸáŸ– áá¾á”áŸ’ášá¶áŸá¶á‘á¢á„áŸ’á‚ášáœááŸ’áááŸ’ášá¼áœá”á¶á“á€áŸá¶á„á¡á¾á„á€áŸ’á“á»á„á‚áŸ„á›á”áŸ†áá„á¢áŸ’áœá¸?"></textarea>

                <div class="flex flex-col md:flex-row items-center justify-between gap-6">
                    <div class="w-full md:w-1/2">
                        <label class="block text-xs font-bold text-yellow-600 uppercase tracking-widest mb-2 ml-2">á”áŸ’ášá—áŸá‘á…á˜áŸ’á›á¾á™ (Type)</label>
                        <select id="answerType" class="w-full bg-black/60 border border-yellow-500/20 rounded-full px-6 py-3 text-yellow-200 outline-none focus:border-yellow-500 transition">
                            <option value="brief">áŸá„áŸ’ááŸá”ááŸ’á›á¸ ááŸ’á›á¹á˜ (Brief)</option>
                            <option value="detailed">á–á“áŸ’á™á›áŸ‹á›á˜áŸ’á¢á·á (Detailed)</option>
                        </select>
                    </div>
                    
                    <button 
                        onclick="askAI()" 
                        id="btnAsk"
                        class="btn-khmer px-12 py-4 rounded-full text-lg shadow-2xl active:scale-95 flex items-center gap-3 w-full md:w-auto justify-center">
                        <span>áŸá¶á€áŸá½ášá¢áŸ’á“á€á‡áŸ†á“á¶á‰</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M5 12h14m-7-7l7 7-7 7"/></svg>
                    </button>
                </div>
            </div>

            <div id="loading" class="hidden py-20 text-center">
                <div class="inline-block relative">
                    <div class="w-20 h-20 border-4 border-yellow-500/20 border-t-yellow-500 rounded-full animate-spin"></div>
                    <div class="absolute inset-0 flex items-center justify-center text-2xl">ğŸ“œ</div>
                </div>
                <p class="mt-6 text-yellow-500 font-bold animate-pulse tracking-widest">á€áŸ†á–á»á„á”á¾á€á€áŸ’ášá¶áŸ†á„áŸáŸ’ášá¶áœá‡áŸ’ášá¶áœ...</p>
            </div>

            <div id="responseSection" class="hidden space-y-6 animate-in slide-in-from-bottom-10 duration-700">
                <div class="gold-glow-card p-10 border-l-[12px] border-yellow-600">
                    <div class="flex items-center justify-between mb-8 border-b border-white/5 pb-4">
                        <span id="responseBadge" class="text-xs font-black tracking-[0.3em] text-yellow-600 uppercase">ARCHIVE_RECORD</span>
                        <button onclick="window.print()" class="text-[10px] font-bold text-slate-500 hover:text-white transition uppercase">SAVE_OFFLINE</button>
                    </div>
                    
                    <div class="flex gap-6">
                        <div class="hidden md:block text-4xl opacity-50 text-yellow-500 leading-none">â€œ</div>
                        <p id="responseText" class="text-slate-100 leading-[1.8] text-xl font-light"></p>
                    </div>
                    <div class="hidden md:flex justify-end text-4xl opacity-50 text-yellow-500 leading-none">â€</div>
                </div>
            </div>
        </div>
    </main>

    <footer class="mt-20 py-10 border-t border-white/5 text-center text-slate-600 text-[10px] tracking-widest uppercase">
        &copy; 2026 AI DevSuite Cambodia - Inspired by Angkor Wat
    </footer>

    <script>
        const socket = io();

        function askAI() {
            const question = document.getElementById("questionInput").value;
            const type = document.getElementById("answerType").value; // âœ… á‘á¶á‰á™á€á‡á˜áŸ’ášá¾áŸá–á¸ Select
            
            if (!question) return Swal.fire({ 
                icon: 'warning', 
                title: 'áŸá¼á˜áœá¶á™áŸáŸ†áá½áš!', 
                text: 'á”á„ AI á˜á·á“á¢á¶á…á‘á¶á™áŠá¹á„áŸáŸ†áá½ášá€áŸ’á“á»á„á…á·ááŸ’áá”áŸ’á¢á¼á“á”á¶á“á‘áŸ!', 
                background: '#0a0a0a', 
                color: '#ffd700', 
                confirmButtonColor: '#b8860b' 
            });

            document.getElementById("loading").classList.remove("hidden");
            document.getElementById("responseSection").classList.add("hidden");
            document.getElementById("btnAsk").disabled = true;
            document.getElementById("btnAsk").style.opacity = "0.5";

            // âœ… á•áŸ’á‰á¾á‘á¶áŸ†á„áŸáŸ†áá½áš á“á·á„á”áŸ’ášá—áŸá‘á…á˜áŸ’á›á¾á™á‘áŸ… Backend
            socket.emit("ask_culture", { question, type });
        }

        socket.on("culture_result", (data) => {
            document.getElementById("loading").classList.add("hidden");
            document.getElementById("responseSection").classList.remove("hidden");
            document.getElementById("btnAsk").disabled = false;
            document.getElementById("btnAsk").style.opacity = "1";
            
            // á”áŸ’áŠá¼áš Badge áá¶á˜á”áŸ’ášá—áŸá‘á…á˜áŸ’á›á¾á™
            const type = document.getElementById("answerType").value;
            document.getElementById("responseBadge").innerText = type === "brief" ? "BRIEF_SUMMARY" : "DETAILED_ANALYSIS";

            typeWriter("responseText", data.response);
        });

        function typeWriter(id, text) {
            let i = 0;
            const el = document.getElementById(id);
            el.innerHTML = "";
            el.classList.add("cursor");
            
            function type() {
                if (i < text.length) {
                    el.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, 15); // á›áŸ’á”á¿á“á›á¿á“á‡á¶á„á˜á»á“á”á“áŸ’áá·á…
                } else {
                    el.classList.remove("cursor");
                }
            }
            type();
        }

        socket.on('error_occured', (msg) => {
            Swal.fire({ icon: 'error', title: 'á”á‰áŸ’á á¶á”áŸ’ášá–áŸá“áŸ’á’', text: msg, background: '#0a0a0a', color: '#fff' });
            document.getElementById("loading").classList.add("hidden");
            document.getElementById("btnAsk").disabled = false;
            document.getElementById("btnAsk").style.opacity = "1";
        });
    </script>
</body>
</html>